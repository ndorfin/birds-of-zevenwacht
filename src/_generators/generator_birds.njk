---
pagination:
  data: birds
  size: 1
  alias: birdId
permalink: "{{ url.birds }}{{ birds[birdId].name | slugify }}/index.html"
layout: "bird_detail.njk"
eleventyExcludeFromCollections: true
---
{% set bird = birds[birdId] %}

<dl class="list_details">
	{% if bird['scientific-name'] %}
		<div>
			<dt>Scientific name</dt>
			<dd>{{ bird['scientific-name'] }}</dd>
		</div>
	{% endif %}
	{% if bird.ebird %}
		<div>
			<dt>Reference</dt>
			<dd><a href="{{ bird.ebird }}">{{ bird.name }} on eBird</a></dd>
		</div>
	{% endif %}
</dl>

{% set birdSightings = sightings | byBird(birdId) %}
{% set birdSightingsArray = birdSightings | objToArray %}
<article aria-labelledby="heading_bird_sightings">
	<header>
		<h3 id="heading_bird_sightings">{{ birdSightingsArray.length }} sightings</h3>
	</header>
	{% if birdSightingsArray.length %}
		<div class="layout_map">
			<div class="layout_item_map">
				<map-embed
					id="area_boundaries"
					sightings="./sightings.json"
					latitude="-33.929"
					longitude="18.72"
					zoom="15"
				></map-embed>
			</div>
			<div class="layout_item_list">	
				<ul>
					{% for sightingId, sighting in birdSightings %}
						<li>
							<a href="{{ url.sightings }}{{ sightingId }}-{{ birdId }}/">
								{{ sighting.bird.quantity }} Ã— {{ bird.name}} on {{ sighting.datetime | CCYYMMDD }}
							</a>
						</li>
					{% endfor %}
				</ul>
			</div>
		<div>
	{% else %}
		<p>No sightings yet</p>
	{% endif %}
</article>

<article aria-labelledby="heading_bird_photos">
	<header>
		{% set birdPhotos = photos | byBird(birdId) | sortByDatetimeRecent %}
		{% set photosArray = birdPhotos | objToArray %}
		<h3 id="heading_bird_photos">{{ photosArray.length }} Photos</h3>
	</header>
	{% if photosArray.length > 1 %}
		<ul class="list_gallery">
			{% for photoId, photo in birdPhotos %}
				{% set exif = exifs[photo.photographer][photo.file] %}
				{% if exif %}
					{% set datetime = exif.DateTimeOriginal %}
				{% else %}
					{% set datetime = photo.datetime %}
				{% endif %}
				<li>
					<a class="link_thumbnail" href="{{ url.photos }}{{ photoId | slugify }}/">
						<figure>
							{% photoThumbnail url.source_photos + photo.photographer + '/' + photo.file, photo.description %}
							<figcpation>
								{% datetime datetime %}
							</figcpation>
						</figure>
					</a>
				</li>
			{% endfor %}
		</ul>
	{% else %}
		<p>No photos yet</p>
	{% endif %}
</article>